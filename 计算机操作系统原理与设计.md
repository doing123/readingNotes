```
年前看了《Windows操作系统原理》尤晋元版，一知半解。又找了几本相关的书籍，按照以后要读的顺序排：《计算机操作系统原理与设计》、《深入理解计算机系统》（卡内基梅隆大学的布莱恩特，以程序员的视角）、《计算机操作系统》（汤小丹等）
```

# 《计算机操作系统原理与设计》

### chapter 1
* 操作系统的主要特性：
    * 并发性：进程
    * 共享性：互斥共享（临界资源）、同时访问
    * 异步性
* 操作系统需要解决的主要问题
    * 提供解决资源冲突的策略和技术
    * 协调并发活动的关系
    * 保证系统的安全性
* 1.2 操作系统的发展和形成
    * 人工操作阶段：
        * 机器语言--汇编语言--高级程序设计语言
    * 管理程序阶段
        * 批处理--脱机批处理
    * 多道程序设计与操作系统的形成
        * 多重处理系统：多物理CPU
        * 多道程序设计：轮流占用CPU
        * 多道程序设计的实现：
            * 存储保护和程序浮动、处理器的管理和调度、系统资源的管理和调度
    * 操作系统的发展动力和进一步发展
* 1.3 操作系统的分类
    * 批处理操作系统
    * 分时
    * 实时
    * 网络
    * 分布式
    * 嵌入式
* 1.4 操作系统的功能
    * 处理器的管理
    * 存储管理
    * 设备管理
    * 文件管理
    * 网络和通信管理
    * 用户接口
* 1.5 操作系统提供的服务和用户接口
    * 基本服务：创建、执行程序，数据I/O，信息存取，通信服务，错误检测和处理，资源分配，统计，保护
    * 用户接口：系统调用、库函数、命令解释程序
* 1.6 流行操作系统简介
### chapter 2 处理器管理
* 2.1 中央处理器
    * 单处理器系统和多处理器系统
    * 寄存器：处理器包括一组寄存器
    * 机器指令
    * 特权指令
    * 处理器状态
    * 程序状态字寄存器
* 2.2 中断技术
    * 概念
    * 中断源的分类：强迫性和资源性；不可屏蔽中断和可屏蔽中断
    * 中断装置
    * 中断事件的处理
    * 中断的优先级和多重中断
    * 实例：Windows2000的中断处理
* 2.3 进程及其实现
    * 定义和性质
        * 进程是一个具有一定独立功能的程序关于某个数据集合的一次运行活动。从操作系统管理的角度，进程由数据结构及在其上执行的程序组成，是程序在这个数据集合上的运行过程，也是操作系统进行资源分配和保护的基本单位。
        * 结构性、共享性（同一程序同时运行在不同数据集合上时，构成不同进程）、动态性、独立性、制约性、并发性
        * 依赖于处理器和主存储器资源
    * 状态和转换
        * 三态
        * 五态
        * 挂起：系统资源（内存）不足，把某些进程挂起，对换到磁盘镜像区中，暂不参与进程的调度
    * 描述
        * os的控制结构：进程控制表、存储、i/o、文件控制表
        * 进程镜像：当一个程序进入计算机的主存储器进行计算就构成了进程。
            * 进程上线文：用户级、系统级、寄存器上下文
            * 一个进程映像：进程控制块、进程数据块、系统/用户堆栈、进程控制块
        * 进程控制块：标识信息、现象信息、控制信息
        * 进程管理：进程队列（单向链接、双向链接）
    * 进程的控制
        * 创建：当OS为一个程序构造一个进程控制块并分配地址空间后，就创建了一个进程。
        * 进程上下文切换：核心态《===》用户态（模式切换）
* 2.4 线程及其实现
    * 引入多线程技术的动机
        * 进程在任一时刻只有一个执行控制流，我们将这种结构的进程称为单线程（结构）进程（single threaded process）
        * 进程作为系统资源分配和保护的独立单位，不需要频繁地切换
        * 线程作为系统调度和分派的基本单位，会频繁的调度的切换
    * 多线程环境中的进程与线程
        * 管理和执行相分离的进程模型
        * 线程：指进程中的一条独立执行路径（控制流），每个进程内允许包含多个并行执行的路径，即多线程。
        * 线程的状态：运行、就绪、阻塞
        * 线程管理和线程库：孵化、封锁、活化、结束、通信、同步、调度等
        * 并发多线程设计的有点：
            ```挂起：意味着将主存空间中的地址空间对换到盘上```
    * 线程的实现
        * 内核级线程（内核空间）
        * 用户级线程
        * 混合式线程
    * 实例: solaris的进程与线程
        ```
            轻量进程：实际上不是进程，只是一个内核支持的用户级线程（ULT）
        ```
    * 实例：window2000 的进程与线程
        ```
            进程、线程、作业
        一个进程只能属于一个作业
        ```
* 2.5 处理机调度
    * 高级调度：作业调度、长程调度
    * 中级调度：平衡负载调度、中程调度
    * 低级调度： 进程调度、短程调度
* 2.6 批处理作业的管理与调度
    * 作业和进程的关系
        ```
        作业是任务的实体，进程是完成任务的执行实体
        ```
    * 批处理作业的管理：作业、进程的调度
    * 批处理作业的调度
    * 作业调度的算法：
        ```
            先来先服务算法：FCFS
            最短作业优先算法：SJF（Shortest Job First）
            响应比最高者优先（HRW）算法：响应比=已等待时间/估计计算时间
            优先数法
            分类调度算法
            用磁带与不用磁带的作业搭配
        ```
* 2.7 进程调度
        * 进程调度的功能：
            ```
                负责动态地把处理器分配给进程或者内核级线程
                非抢占式和抢占式
                高低优先级队列，队列内采用非抢占式，但队列间采用抢占式
            ```
        * 进程调度算法
            ```
                先来先服务算法
                时间片轮转调度
                优先权调度
                多级反馈队列调度
                保证调度算法
                彩票调度算法
            ```
        * 实时调度
            ```
                实时系统分：硬实时系统、软实时系统
                响应事件：周期性事件、非周期性事件
                实时调度算法：
                    分动态实时算法和静态实时算法
                    单比率调度算法：最优
                    限期调度算法
                    最少裕度法
            ```
        * 多处理器调度
            ```
                松散耦合多处理器系统：cluster，独立处理器
                紧密耦合多处理器系统：一组处理器，共享外存、外设
            ```
            * 同步的粒度（频率）：
                ```
                    细粒度：同步周期 < 20条指令
                    中粒度： 20-200
                    粗粒度：200-2000
                    超粗粒度： > 2000
                    独立：线程、进程间不存在同步
                ```
            * 多处理器调度的设计要点：
                ```
                    进程如何分配给处理器：动态、静态分配策略
                    是否在单个处理器上支持多道程序设计
                    如何指派进程
                ```
            * 多处理器调度算法
                ```
                    主要研究对象时线程调度算法：
                        负载共享调度算法
                        群调度算法
                        处理器专派调度算法
                        动态调度算法：操作系统和应用进程共同完成调度
                ```
            * 实例研究：传统Unix调度算法
                ```
                    采用多级反馈队列，对每一个优先级队列采用时间片调度策略
                ```
            * 实例研究：Unix SVR4：优先级、优先数
            * 实例研究：windowNT
                ```
                    优先级层次：实时优先级层次：31-16
                    可变优先级层次：15-0
                ```

    
        

### chapter 3 并发进程
* 3.1 并发进程
    * 顺序程序设计：顺序性、封闭性、确定性和可再现性
    * 进程的并发性
    * 与时间有关的错误
    * 进程的交互：协作（同步）和竞争（互斥），死锁、饥饿问题
* 3.2 临界区管理
    ```
        互斥和临界区：临界资源。
        临界区调度原则：无空等待、有空让进、择一而入、算法可行
        临界区管理的尝试：标志的方式
        实现临界区管理的软件方法：
            Dekker算法
            Peterson算法：标志+turn指针
        实现临界区管理的硬件方法：
            关中断
            测试并建立指令
            对换指令
    ```
* 3.3 信号量与PV操作
    * 同步与同步机制
    * 记录型信号量和PV操作：p(测试)、v(增量)
        * 整型信号量
        * 记录型信号量
    * 用记录型信号量实现互斥
    * 记录型信号量解决生产者--消费者问题：访问缓冲器的速率
    * 记录型信号量解决读者--写者问题
    * 记录型信号量解决理发师问题
    * AND型信号量机制：把进程运行期间的所要临界资源，一次性全部分配给进程，待该进程使用完临界资源后再全部释放
    * 一般信号量机制
* 3.4 管程
    * 管程和条件变量
        * 管程：代表共享资源的数据及在其上的操作的一组过程构成了管程，管程被请求和释放资源的进程所调用
    * Hanson方法实现管程
        * 4条原语：wait,signal,check,release
    * Hoare方法实现管程
* 3.5 进程通信：IPC，InterProcess Communication
    * 进程通信机制：通过软中断，是一种简单的通信机制，通过发送一个指定信号来通知进程某个异常事件的发生
    * 共享文件通信机制：
        * 管道：pipeline，是连接读写进程的一个特殊文件，允许进程按先进先出方式传送数据，也能使进程同步执行操作
    * 共享存储区通信机制：
        ```
            方式： 直接通信机制：消息缓冲区
                   间接通信机制：信箱方式，Unix的pipeline和socket机制；分信箱特征和信箱体两部分
        ```
    * 有关消息传递实现的若干问题
        ```
            信箱容量问题
            关于多进程与信箱相连的信件接收问题
            关于信箱的所有权问题
            关于信件的格式问题：定长、变长
            关于通信机制并行性问题
        ```
* 3.6 死锁
    * 死锁的产生：在许多应用中，一个进程需独占不止一种资源。而操作系统允许多个进程并发执行共享资源时，此时可能会出现进程永远被阻塞的现象。如：两个进程分别等待对方占用的一个资源，于是两者都不能执行而处于永远的等待，这种现象称为‘死锁’。
        ```
            竞争资源死锁
            PV操作使用不当产生死锁
            资源分配不当引起死锁
            对临界性资源使用不加限制引起的死锁
        ```
    * 死锁的防止：避免、检测和解除
    * 死锁的定义：如在一个进程集合中的每个进程都在等待只能由该集合中的其他一个进程才能引发的事件，则称一组进程或系统此时发生了死锁
    * 鸵鸟算法：视而不见
    * 死锁的产生
        ```
            条件：
                互斥条件
                占有和等待条件
                不剥夺条件
                循环等待条件
            静态分配策略：一个进程必须在执行前就申请它所要的全部资源，且得到满足后才开始执行
            层次分配策略：提高了资源的利用率
        ```
    * 死锁的避免：对资源的分配加以限制
        ```
            资源轨迹图
            单种资源的银行家算法
            多种资源的银行家算法
            银行家算法的数据结构和安全性测试算法
            银行家算法的基本思想：P133
        ```
    * 死锁的检测和解除
        * 安全性测试算法
        * 可设置两张表格来记录进程使用资源的情况
    * 混合策略

### chapter 4：存储管理
    主存储器空间分系统区和用户区，用户区存储用户程序和数据。存储管理主要针对用户区，还有辅存储器
* 4.1 主存储器
    * 存储器的层次：
        ``` 
            访问速度：寄存器》高速缓存》主存储器》磁盘缓存
        ```
    * 快速缓存
    * 地址转换与存储保护
        ```
            相对地址：逻辑地址
            物理地址：绝对地址
            为了保证程序的正确运行，必须把程序和数据的逻辑地址转换为物理地址，这一工作成为地址转换或重定位。
        ```
* 4.2 连续存储空间管理
    * 单用户连续存储管理
        ```
            静态重定向：栅栏寄存器（界限地址）
            动态重定向：定位寄存器
        ```
    * 固定分区存储管理：上、下限寄存器
    * 可变分区存储管理
        * 主存空间的分配和去配：主存分配表
            * 空闲区分配方法：链表、表格
        * 可变分区管理的分配算法
            * 最先适用分配算法
            * 最优适应
            * 最坏适应
        * 地址转换与存储保护：基址寄存器、限长寄存器
    * 移动技术
* 4.3 分页式存储管理
    * 基本原理
        ```
            页框：物理地址
            页面
            逻辑地址形式：页号和单元号
            页表和地址转换：页表控制寄存器（系统唯一）
        ```
    * 相联寄存器和快表：相联寄存器，系统唯一，只有占用CPU者才占有相联寄存器
    * 分页式存储空间的分配和去配
    * 多级页表
    * 反置页表
* 4.4 分段式存储管理
    * 程序的分段结构
    * 基本原理：段号、段内地址
    * 段的共享
    * 分段和分页的比较：分段是信息的逻辑单位，由源程序的逻辑结构所决定；分页是物理单位，与源程序的逻辑结构无关。
* 4.5 虚拟存储管理
    * 概念
    * 分页式虚拟存储系统
        * 基本原理
        * 页面装入策略和清除策略：请页式调度、预调式调度
        * 页面分配侧罗：固定、可变分配
        * 页面替换策略
            ```
                随机页面替换算法
                先进先出
                最少使用
                第二次机会
                时钟
                最不常用
            ```
        * 页式虚拟存储系统的几个设计问题
            ```
                页面大小
                工作集模型
                页面交换区
                写时复制
            ```
        * 分段式虚拟存储系统
        * 段页式存储系统
            ```
                虚地址：段
                实地址：页框（块）
                作业表、链表、页表
            ```
* 4.6 实例研究：Inter Pentium
    * 描述符表
    * 段选择符和段描述符
* 4.7 实例研究：Linux存储管理
    * 分页管理
    * 交换空间
    * 页的换进换出

### chapter 5 设备管理
* 5.1 I/O硬件原理
    * I/O系统：通常把I/O设备及其接口路线、控制部件、通道和管理软件成为I/O系统，把计算机的主存和外围设备的介质之间的信息传送操作成为输入输出操作。
        * 输入型外围设备
        * 输出型
        * 存储型外围设备：顺序存取存储设备、直接存取存储设备
    * I/O控制方式
        * 询问方式：程序直接控制方式
        * 中断方式
        * DMA方式：Direct Memory Access，直接存储器存取
            * 主存地址寄存器
            * 字计数器
            * 设备地址寄存器
            * 中断机制和控制逻辑
        * 通道方式：输入输出处理器
            * 字节多路通道
            * 选择通道
            * 数组多路通道
    * 设备控制器：I/O设备通常包括一个机械部件和一个电子部件
        ```
            主要功能：
                接收和识别CPU或通道发来的命令
                实现数据交换
                发现和记录设备自身的状态信息
                设备地址识别
        ```
* 5.2 I/O软件原理
    * I/O软件的设计目标和原则
        * 高效率和通用性
        ```
            问题：设备无关性
                出错处理
                同步（阻塞）--异步（中断驱动）传输
                独占性和共享性外围设备
        ```
    * I/O软件的四个层次
        ```
            用户进程：处理I/O调用；格式化I/O
            设备无关软件：命名、保护、阻塞、缓冲、分配
            设备驱动程序：建立设备寄存器，检查状态
            中断处理程序：当I/O结束时，唤醒驱动程序
            硬件：执行I/O操作
        ```
* 5.3 具有通道的I/O系统管理
    * 通道命令和通道程序
        * 通道：I/O处理机
        * 通道命令：CCW，Channel Command Word
        * 通道地址字：CAW，Channel Address Word
        * 通道状态字：CSW
    * I/O指令和主机I/O程序
    * 通道启动和I/O操作过程：I/O启动阶段、操作、结束
* 5.4 缓存技术
    * I/O缓冲区
    * 单缓冲
    * 双缓冲：缓冲交换，buffer swapping
    * 多缓冲：循环缓冲，circular buffer；预先读、异步写、延迟写
* 5.5 驱动调度技术
    * todo:--
    
